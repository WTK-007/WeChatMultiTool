<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å¾®ä¿¡å¤šå¼€å™¨</title>

  <!-- plausible -->
  <script defer data-domain="wechatmult.site" src="https://plausible.io/js/script.js"></script>

  <!-- clarity -->
  <script type="text/javascript">
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "rrj77ylx24");
  </script>
  
  <style>
      * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
      }

      body {
          font-family: 'Microsoft YaHei', Arial, sans-serif;
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          min-height: 100vh;
          display: flex;
          justify-content: center;
          align-items: center;
          padding: 20px;
      }

      .container {
          background: white;
          border-radius: 15px;
          box-shadow: 0 20px 40px rgba(0,0,0,0.1);
          padding: 40px;
          width: 100%;
          max-width: 600px;
      }

      .title {
          text-align: center;
          color: #333;
          font-size: 28px;
          font-weight: bold;
          margin-bottom: 30px;
          position: relative;
      }

      .title::after {
          content: '';
          position: absolute;
          bottom: -10px;
          left: 50%;
          transform: translateX(-50%);
          width: 60px;
          height: 3px;
          background: linear-gradient(90deg, #667eea, #764ba2);
          border-radius: 2px;
      }

      .form-group {
          margin-bottom: 25px;
      }

      .form-label {
          display: block;
          margin-bottom: 8px;
          color: #555;
          font-weight: 500;
          font-size: 14px;
      }

      .form-input {
          width: 100%;
          padding: 12px 15px;
          border: 2px solid #e1e5e9;
          border-radius: 8px;
          font-size: 14px;
          transition: all 0.3s ease;
          background: #fafbfc;
      }

      .form-input:focus {
          outline: none;
          border-color: #667eea;
          background: white;
          box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      }

      .path-input-group {
          display: flex;
          gap: 10px;
      }

      .path-input {
          flex: 1;
      }

      .help-btn {
          padding: 12px 20px;
          background: #28a745;
          color: white;
          border: none;
          border-radius: 8px;
          cursor: pointer;
          font-size: 14px;
          transition: all 0.3s ease;
          white-space: nowrap;
      }

      .help-btn:hover {
          background: #218838;
          transform: translateY(-1px);
      }

      .number-input {
          text-align: center;
          font-size: 16px;
          font-weight: bold;
      }

      .run-btn {
          width: 100%;
          padding: 15px;
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          color: white;
          border: none;
          border-radius: 10px;
          font-size: 16px;
          font-weight: bold;
          cursor: pointer;
          transition: all 0.3s ease;
          margin-top: 10px;
      }

      .run-btn:hover {
          transform: translateY(-2px);
          box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
      }

      .run-btn:active {
          transform: translateY(0);
      }

      .run-btn:disabled {
          background: #ccc;
          cursor: not-allowed;
          transform: none;
          box-shadow: none;
      }

      .status {
          margin-top: 20px;
          padding: 15px;
          border-radius: 8px;
          text-align: center;
          font-weight: 500;
          display: none;
      }

      .status.success {
          background: #d4edda;
          color: #155724;
          border: 1px solid #c3e6cb;
      }

      .status.error {
          background: #f8d7da;
          color: #721c24;
          border: 1px solid #f5c6cb;
      }

      .status.info {
          background: #d1ecf1;
          color: #0c5460;
          border: 1px solid #bee5eb;
      }

      .note {
          background: #fff3cd;
          border: 1px solid #ffeaa7;
          color: #856404;
          padding: 15px;
          border-radius: 8px;
          margin-top: 20px;
          font-size: 13px;
          line-height: 1.5;
      }

      .note strong {
          color: #6c5500;
      }

      .help-modal {
          display: none;
          position: fixed;
          z-index: 1000;
          left: 0;
          top: 0;
          width: 100%;
          height: 100%;
          background-color: rgba(0,0,0,0.5);
          backdrop-filter: blur(5px);
      }

      .help-modal-content {
          background-color: white;
          margin: 5% auto;
          padding: 30px;
          border-radius: 15px;
          width: 90%;
          max-width: 700px;
          max-height: 80vh;
          overflow-y: auto;
          position: relative;
          box-shadow: 0 20px 40px rgba(0,0,0,0.2);
      }

      .close-btn {
          position: absolute;
          top: 15px;
          right: 20px;
          font-size: 28px;
          font-weight: bold;
          color: #aaa;
          cursor: pointer;
          transition: color 0.3s;
      }

      .close-btn:hover {
          color: #000;
      }

      .help-title {
          color: #333;
          font-size: 24px;
          font-weight: bold;
          margin-bottom: 20px;
          text-align: center;
      }

      .help-steps {
          margin-bottom: 20px;
      }

      .help-step {
          margin-bottom: 15px;
          padding: 15px;
          background: #f8f9fa;
          border-radius: 8px;
          border-left: 4px solid #667eea;
      }

      .help-step-title {
          font-weight: bold;
          color: #333;
          margin-bottom: 8px;
          font-size: 16px;
      }

      .help-step-desc {
          color: #666;
          line-height: 1.5;
      }

      .help-image {
          width: 100%;
          max-width: 500px;
          height: auto;
          border-radius: 8px;
          box-shadow: 0 4px 8px rgba(0,0,0,0.1);
          margin: 15px auto;
          display: block;
      }

      .highlight {
          background: #fff3cd;
          padding: 2px 6px;
          border-radius: 4px;
          color: #856404;
          font-weight: 500;
      }

      .warning {
          background: #f8d7da;
          border: 1px solid #f5c6cb;
          color: #721c24;
          padding: 12px;
          border-radius: 6px;
          margin: 15px 0;
          font-size: 14px;
      }

      .warning strong {
          color: #721c24;
      }

      .common-paths {
          background: #e7f3ff;
          border: 1px solid #b8daff;
          color: #004085;
          padding: 15px;
          border-radius: 8px;
          margin: 15px 0;
      }

      .common-paths strong {
          color: #004085;
      }

      .path-example {
          font-family: 'Courier New', monospace;
          background: #f1f3f4;
          padding: 8px 12px;
          border-radius: 4px;
          margin: 5px 0;
          display: block;
          word-break: break-all;
      }
  </style>
</head>
<body>
  <div class="container">
      <h1 class="title">å¾®ä¿¡å¤šå¼€å™¨</h1>
      
      <form id="launcherForm">
          <div class="form-group">
              <label class="form-label" for="wechatPath">å¾®ä¿¡ç¨‹åºè·¯å¾„</label>
              <div class="path-input-group">
                  <input type="text" 
                         id="wechatPath" 
                         class="form-input path-input" 
                         placeholder="è¯·è¾“å…¥å¾®ä¿¡ç¨‹åºçš„å®Œæ•´è·¯å¾„">
                  <button type="button" class="help-btn" onclick="showHelp()">å¦‚ä½•æ‰¾åˆ°ï¼Ÿ</button>
              </div>
          </div>

          <div class="form-group">
              <label class="form-label" for="instanceCount">å¤šå¼€æ•°é‡</label>
              <input type="number" 
                     id="instanceCount" 
                     class="form-input number-input" 
                     min="1" 
                     max="10" 
                     placeholder="è¯·è¾“å…¥è¦å¯åŠ¨çš„å¾®ä¿¡æ•°é‡(1-10)">
          </div>

          <button type="submit" class="run-btn" id="runBtn">
              ğŸš€ å¯åŠ¨å¾®ä¿¡å¤šå¼€
          </button>
      </form>

      <div id="status" class="status"></div>

      <div class="note">
          <strong>ä½¿ç”¨è¯´æ˜ï¼š</strong><br>
          1. è¯·ç¡®ä¿å¾®ä¿¡ç¨‹åºè·¯å¾„æ­£ç¡®ï¼Œç‚¹å‡»"å¦‚ä½•æ‰¾åˆ°ï¼Ÿ"æŸ¥çœ‹è¯¦ç»†æ•™ç¨‹<br>
          2. åªé€‚ç”¨äºWindowsç³»ç»Ÿçš„ç”µè„‘<br>
          3. å¤šå¼€æ•°é‡å»ºè®®ä¸è¶…è¿‡5ä¸ªï¼Œé¿å…ç³»ç»Ÿå¡é¡¿<br>
          4. éƒ¨åˆ†æ€æ¯’è½¯ä»¶å¯èƒ½ä¼šæ‹¦æˆªï¼Œè¯·æ·»åŠ ä¿¡ä»»
      </div>
  </div>

  <!-- å¸®åŠ©å¼¹çª— -->
  <div id="helpModal" class="help-modal">
      <div class="help-modal-content">
          <span class="close-btn" onclick="closeHelp()">&times;</span>
          <h2 class="help-title">ğŸ“ å¦‚ä½•æ‰¾åˆ°å¾®ä¿¡ç¨‹åºè·¯å¾„</h2>
          
          <div class="help-steps">
              <div class="help-step">
                  <div class="help-step-title">ç¬¬ä¸€æ­¥ï¼šæ‰¾åˆ°å¾®ä¿¡å›¾æ ‡</div>
                  <div class="help-step-desc">
                      åœ¨æ¡Œé¢æˆ–å¼€å§‹èœå•ä¸­æ‰¾åˆ°å¾®ä¿¡å›¾æ ‡ï¼Œ<span class="highlight">å³é”®ç‚¹å‡»</span>å¾®ä¿¡å›¾æ ‡
                  </div>
              </div>

              <div class="help-step">
                  <div class="help-step-title">ç¬¬äºŒæ­¥ï¼šæ‰“å¼€å±æ€§</div>
                  <div class="help-step-desc">
                      åœ¨å¼¹å‡ºçš„å³é”®èœå•ä¸­ï¼Œç‚¹å‡»<span class="highlight">"å±æ€§"</span>é€‰é¡¹
                  </div>
              </div>

              <div class="help-step">
                  <div class="help-step-title">ç¬¬ä¸‰æ­¥ï¼šåˆ‡æ¢åˆ°å¿«æ·æ–¹å¼</div>
                  <div class="help-step-desc">
                      åœ¨å±æ€§çª—å£ä¸­ï¼Œç‚¹å‡»<span class="highlight">"å¿«æ·æ–¹å¼"</span>é€‰é¡¹å¡
                  </div>
              </div>

              <div class="help-step">
                  <div class="help-step-title">ç¬¬å››æ­¥ï¼šå¤åˆ¶ç›®æ ‡è·¯å¾„</div>
                  <div class="help-step-desc">
                      æ‰¾åˆ°<span class="highlight">"ç›®æ ‡(T)"</span>ä¸€æ ï¼Œå¤åˆ¶å…¶ä¸­çš„å®Œæ•´è·¯å¾„
                  </div>
              </div>
          </div>

          <img src="image/example.png" 
               alt="å¾®ä¿¡å±æ€§è®¾ç½®ç¤ºä¾‹" 
               class="help-image"
               onerror="this.onerror=null; this.style.display='flex'; this.style.alignItems='center'; this.style.justifyContent='center'; this.style.minHeight='200px'; this.style.background='#f0f0f0'; this.style.border='2px dashed #ccc'; this.style.color='#666'; this.innerHTML='å›¾ç‰‡åŠ è½½å¤±è´¥ï¼Œè¯·å‚è€ƒæ–‡å­—è¯´æ˜'">
          
          <div class="warning">
              <strong>âš ï¸ é‡è¦æé†’ï¼š</strong><br>
              â€¢ åªå¤åˆ¶è·¯å¾„å†…å®¹ï¼Œ<strong>ä¸è¦å¤åˆ¶å¼•å·</strong><br>
              â€¢ ç¡®ä¿è·¯å¾„ä»¥ <code>.exe</code> ç»“å°¾<br>
              â€¢ å¦‚æœç›®æ ‡æ ä¸­æœ‰å¼•å·ï¼Œè¯·å»æ‰å¼•å·åå†å¤åˆ¶
          </div>

          <div class="common-paths">
              <strong>ğŸ’¡ å¸¸è§å¾®ä¿¡å®‰è£…è·¯å¾„ï¼š</strong><br>
              <span class="path-example">C:\Program Files (x86)\Tencent\WeChat\WeChat.exe</span>
              <span class="path-example">D:\Program Files\Tencent\WeChat\WeChat.exe</span>
              <span class="path-example">C:\Program Files\Tencent\WeChat\WeChat.exe</span>
              <span class="path-example">E:\WeChat\WeChat.exe</span>
          </div>
      </div>
  </div>

  <script>
      function showStatus(message, type = 'info') {
          const statusDiv = document.getElementById('status');
          statusDiv.textContent = message;
          statusDiv.className = `status ${type}`;
          statusDiv.style.display = 'block';
      }

      function showHelp() {
          document.getElementById('helpModal').style.display = 'block';
      }

      function closeHelp() {
          document.getElementById('helpModal').style.display = 'none';
      }

      // ç‚¹å‡»å¼¹çª—å¤–éƒ¨å…³é—­
      window.onclick = function(event) {
          const modal = document.getElementById('helpModal');
          if (event.target === modal) {
              modal.style.display = 'none';
          }
      }

      function generateBatchScript(wechatPath, count) {
          let script = '@echo off\n\n';
          
          for (let i = 0; i < count; i++) {
              // ä½¿ç”¨åŒå¼•å·æ ¼å¼ï¼ˆç»è¿‡æµ‹è¯•çš„æœ‰æ•ˆæ ¼å¼ï¼‰
              script += `start "" "${wechatPath}""\n\n`;
          }
          
          script += 'exit';
          
          return script;
      }

      function downloadBatchFile(content, filename) {
          const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
          const url = window.URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = filename;
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          window.URL.revokeObjectURL(url);
      }

      document.getElementById('launcherForm').addEventListener('submit', function(e) {
          e.preventDefault();
          
          const wechatPath = document.getElementById('wechatPath').value.trim();
          const instanceCount = parseInt(document.getElementById('instanceCount').value);
          const runBtn = document.getElementById('runBtn');
          
          // éªŒè¯è¾“å…¥
          if (!wechatPath) {
              showStatus('è¯·è¾“å…¥å¾®ä¿¡ç¨‹åºè·¯å¾„ï¼ç‚¹å‡»"å¦‚ä½•æ‰¾åˆ°ï¼Ÿ"æŸ¥çœ‹æ•™ç¨‹', 'error');
              return;
          }
          
          if (!instanceCount || instanceCount < 1 || instanceCount > 10) {
              showStatus('è¯·è¾“å…¥æœ‰æ•ˆçš„å¤šå¼€æ•°é‡ï¼ˆ1-10ï¼‰ï¼', 'error');
              return;
          }
          
          // æ£€æŸ¥è·¯å¾„æ ¼å¼
          if (!wechatPath.toLowerCase().endsWith('.exe')) {
              showStatus('è·¯å¾„æ ¼å¼ä¸æ­£ç¡®ï¼Œè¯·ç¡®ä¿ä»¥ .exe ç»“å°¾ï¼', 'error');
              return;
          }
          
          // ç¦ç”¨æŒ‰é’®
          runBtn.disabled = true;
          runBtn.textContent = 'æ­£åœ¨ç”Ÿæˆ...';
          
          try {
              // ç”Ÿæˆæ‰¹å¤„ç†è„šæœ¬
              const batchScript = generateBatchScript(wechatPath, instanceCount);
              
              // ä¸‹è½½æ‰¹å¤„ç†æ–‡ä»¶
              const filename = `å¾®ä¿¡å¤šå¼€å™¨_${instanceCount}ä¸ª_${new Date().getTime()}.bat`;
              downloadBatchFile(batchScript, filename);
              
              showStatus('å·²ç”Ÿæˆè„šæœ¬æ–‡ä»¶ï¼Œè¯·ä¸‹è½½ååŒå‡»æ‰§è¡Œï¼Œæ‰§è¡Œå‰ç¡®ä¿å…³é—­æ‰€æœ‰å¾®ä¿¡ç¨‹åºï¼', 'success');
              
          } catch (error) {
              showStatus('ç”Ÿæˆæ‰¹å¤„ç†æ–‡ä»¶æ—¶å‡ºé”™ï¼š' + error.message, 'error');
          } finally {
              // æ¢å¤æŒ‰é’®
              setTimeout(() => {
                  runBtn.disabled = false;
                  runBtn.textContent = 'ğŸš€ å¯åŠ¨å¾®ä¿¡å¤šå¼€';
              }, 2000);
          }
      });

      // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
      document.addEventListener('DOMContentLoaded', function() {
          showStatus('å¾®ä¿¡å¤šå¼€å™¨å·²å°±ç»ªï¼å¦‚ä¸çŸ¥é“è·¯å¾„ï¼Œè¯·ç‚¹å‡»"å¦‚ä½•æ‰¾åˆ°ï¼Ÿ"æŸ¥çœ‹æ•™ç¨‹', 'info');
      });
  </script>
</body>
</html>
